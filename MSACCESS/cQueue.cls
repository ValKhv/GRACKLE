VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
END
Attribute VB_Name = "cQueue"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = True
'******************************************************************************************************************************************************
'******************************************************************************************************************************************************
' The class gives a simple imputation of the Queue abstract structure
'   @ Valery Khvatov (valery.khvatov@gmail.com), [01/20180524]
'******************************************************************************************************************************************************
'******************************************************************************************************************************************************
Option Explicit

Private m_Queue As Object


'///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
'//////////////////////######///######////######///######///#####///#####////######//####///######///######/////////////////////////////////////////
'//////////////////////##//##///##///##///##//##///##//##///##//////##///##////##/////##////##////////##////////////////////////////////////////////
'//////////////////////#####////######////##//##///#####////####////######/////##/////##////####////////##//////////////////////////////////////////
'//////////////////////##///////##////#///##//##///##///////##//////##////#////##/////##////##///////////##/////////////////////////////////////////
'//////////////////////##///////##////##//######///##///////#####///##////##///##////####///######////######////////////////////////////////////////
'///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
Public Property Get Count() As Long
    Count = m_Queue.Count
End Property

'//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
'///////////////////////###/////###///#####///######///##///##///######///###//////#####///////////////////////////////////////////////////////////
'///////////////////////##/#///#/##///##////////##/////##///##///##//##///##/#/////##//////////////////////////////////////////////////////////////
'///////////////////////##//#/#//##///####//////##/////#######///##//##///##//#/////##/////////////////////////////////////////////////////////////
'///////////////////////##///#///##///##////////##/////##///##///##//##///##///#//////##///////////////////////////////////////////////////////////
'///////////////////////##///////##///#####/////##/////##///##///######///#####////#####///////////////////////////////////////////////////////////
'//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
Public Function ToArray() As Variant()
    ToArray = m_Queue.ToArray()
End Function
Public Function Clear()
    m_Queue.Clear
End Function

'===================================================================================================================================================
' Removes and returns the object at the beginning of the Queue.
'===================================================================================================================================================
Public Function Dequeue() As Variant
    Dequeue = m_Queue.Dequeue
End Function
'===================================================================================================================================================
' Adds an object to the end of the Queue.
'===================================================================================================================================================
Public Function Enqueue(value As Variant)
    m_Queue.Enqueue value
End Function

'===================================================================================================================================================
' Returns the object at the beginning of the Queue without removing it.
'===================================================================================================================================================
Public Function Peek()
    Peek = m_Queue.Peek()
End Function
'===================================================================================================================================================
' Returns the object at the top of the Stack without removing it.
'===================================================================================================================================================
Public Function ToString()
    ToString = m_Queue.ToString()
End Function

'///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
'//////////////////////#####///##////#///#####///###///##///######///#####//////////////////////////////////////////////////////////////////////////
'//////////////////////##//////##///#////##//////##/#//##/////##/////##/////////////////////////////////////////////////////////////////////////////
'//////////////////////####////##//#/////####////##//#/##/////##//////##////////////////////////////////////////////////////////////////////////////
'//////////////////////##//////##/#//////##//////##///###/////##////////##//////////////////////////////////////////////////////////////////////////
'//////////////////////#####///###///////#####///##////##/////##/////#####//////////////////////////////////////////////////////////////////////////
'///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
Private Sub Class_Initialize()
    Set m_Queue = CreateObject("System.Collections.Queue")
End Sub
Private Sub Class_Terminate()
    If (Not m_Queue Is Nothing) Then m_Queue.Clear
    Set m_Queue = Nothing
End Sub

'//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
'//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
'//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
'//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
'//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
'------------------------------------------------------------------------------------------------------------------------------------------------------
'   ERROR HANDLER FOR cStack
'------------------------------------------------------------------------------------------------------------------------------------------------------
Private Function ErrPrint(FuncName As String, ErrNumber As Long, ErrDescription As String, Optional bDebug As Boolean = True, _
                                                                                                 Optional sModName As String = "cStack") As String
Dim sRes As String
Const ErrChar As String = "#"
Const ErrRepeat As Integer = 60


sRes = String(ErrRepeat, ErrChar) & vbCrLf & "ERROR OF [" & sModName & ": " & FuncName & "]" & vbTab & "ERR#" & ErrNumber & vbTab & Now() & _
                                                          vbCrLf & ErrDescription & vbCrLf & String(ErrRepeat, ErrChar)


If bDebug Then Debug.Print sRes
'--------------------------------------------------
ExitHere:
    Beep
    ErrPrint = sRes   '!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
End Function

